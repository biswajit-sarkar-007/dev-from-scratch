## ORM

- ORMs let you easily interact with your database without worrying too much about the underlying syntax (SQL language for eg)

### some reason why we used ORM:

- Simpler syntax (converts objects to SQL queries under the hood)

- Abstraction that lets you flip the database you are using. Unified API irrespective of the DB

- Type safety/Auto completion

- Automatic migrations

### what is prisma?

Next generation Node js and TypeScript ORM
prisma unlocks a new level of developer experience when working with databases thanks to its intuitive data model, automated migrations, type-safety & auto-completion.

- Data model

- Automated migrations

- Type Safety

- Auto completion

### install prims in a fresh project.

- npx prisma init

- after this you have to migrate the database

- npx prisma migrate dev --name Initialize the schema

- then after some chanages in schema.prisma file thne run

- npx prisma migrate dev --name user_updated

### How to generate the client?

- npx prisma generate

// autogenerated client

#### what is client?

Client represents all the functions that convert

> User.create({email: "user@gmail.com"})

into

> INSERT INTO users VALUES ...

Once you’ve created the _prisma/schema.prisma_ , you can generate these _clients_ that you can use in your Node.js app

#### How to generate the client?

> npx prisma generate
> or,
> npm i @prisma/client

This generates a new client for you.

#### Insert

Write a function that let’s you insert data in the Users table.

```

import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

async function insertUser(username: string, password: string, firstName: string, lastName: string) {
   const res = await prisma.user.create({
    data:{

    }
   })
}

```

#### Update

Write a function that let’s you update data in the Users table.

```
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

interface UpdateParamas {
    firstName:string,
    lastName:string
}
async function updateUser(username: string, {firstName, lastName}:UpdateParamas) {
   const res = await prisma.user.update({
    where;{
      {username}
    },
    data:{
       firstName,
       lastName
    }
   })
}

```

#### Get a user’s details

Write a function that let’s you fetch the details of a user given their email
Starter code

```
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

async function getUser(username: string) {
  const user = await prisma.user.findFirst({
    where:{
        username:username
    }
  })
}

```

### Relationships

Prisma let’s you define relationships to relate tables with each other.

#### Types of relationships

- One to One
- One to Many
- Many to One
- Many to Many

#### Updating the prisma schema

```


generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:mysecretpassword@localhost:5432/postgres"
}

model User {
  id         Int      @id @default(autoincrement())
  username   String   @unique
  password   String
  firstName  String
  lastName   String
  todos      Todo[]
}

model Todo {
  id          Int     @id @default(autoincrement())
  title       String
  description String
  done        Boolean @default(false)
  userId      Int
  user        User    @relation(fields: [userId], references: [id])
}

```

#### Update the database and the prisma client

> npx prisma migrate dev --name relationship
> npx prisma generate
