<html>
<body>
    <input id="title" type="text" placeholder="todo name"> <br>
    <input id="description" type="text" placeholder="todo description"> <br>

    <div id="container"></div>

    <script>
        function createChild(title, description, id) {
            const child = document.createElement("div");

            const firstGrandParent = document.createElement("div");
            firstGrandParent.innerHTML = title;

            const secondGrandParent = document.createElement("div");
            secondGrandParent.innerHTML = description;

            const thirdGrandParent = document.createElement("button");
            thirdGrandParent.innerHTML = "Mark as done";
            thirdGrandParent.setAttribute("onClick", `markAsDone(${id})`);

            child.appendChild(firstGrandParent);
            child.appendChild(secondGrandParent);
            child.appendChild(thirdGrandParent);
            child.setAttribute("id", id);

            return child;
        }

        function updateToState(state) {
            const parent = document.getElementById("container"); 
            parent.innerHTML = "";
            for (let i = 0; i < state.length; i++) {
                const child = createChild(state[i].title, state[i].description, state[i].id);  
                parent.appendChild(child);
            }
        }

        function markAsDone(id) {
            const item = document.getElementById(id);
            item.style.textDecoration = "line-through";  
        }

        // updateToState([
        //     {
        //         id: 1,
        //         title: "Go to gym",
        //         description: "Go to gym at 7:30pm"
        //     },
        //     {
        //         id: 2,
        //         title: "Go to college",
        //         description: "Go to college at 9:00am"
        //     }
        // ])


        window.setInterval(async function(){
            const res = await fetch("http://localhost:3000/todos");
            const json =  await  res.json();
            updateToState(json)
        }, 3000)

    </script>
</body>
</html>
